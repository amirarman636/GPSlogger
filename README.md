مشاهدات اصلی
نوع تخلفات و حملات
درخواست‌های دریافت‌شده به سرور نشان‌دهنده تخلف از پروتکل HTTP بودند. این درخواست‌ها با استفاده از هدر Host که به‌جای دامنه، یک آدرس IP داشت، ارسال شده بودند. نوع حمله شناسایی‌شده یک HTTP Parser Attack بود که به صورت خودکار توسط سیستم شناسایی و مسدود شد.

مسدودسازی موفق درخواست‌ها
تمام درخواست‌های مشکوک توسط سیاست امنیتی سرور مسدود شدند. هیچ پاسخی به این درخواست‌ها ارسال نشد، که نشان‌دهنده عملکرد صحیح مکانیزم‌های دفاعی است.

جزئیات درخواست‌ها
درخواست‌ها شامل موارد زیر بودند:

روش HTTP: بیشتر درخواست‌ها از نوع GET بودند.
مسیرهای هدف: مسیرهایی مانند / (صفحه اصلی سایت) و فایل‌های JavaScript مانند /jquery-3.3.1.slim.min.js.
هدرهای خاص: استفاده از هدرهایی مانند X-Forwarded-For و مقادیر خاص مثل XDEBUG_SESSION_START=phpstorm، که ممکن است تلاش‌هایی برای بررسی آسیب‌پذیری یا اشکال‌زدایی باشد.
رفتار و الگوها
رفتار ترافیک نشان‌دهنده تلاش‌های مکرر برای بررسی نقاط ضعف سرور بود. همچنین، استفاده از مقادیر مختلف برای User-Agent، مانند مرورگرهای شناخته‌شده و مقادیر سفارشی، احتمال تلاش برای شناسایی روش‌های دسترسی مخرب را افزایش می‌دهد.

عملکرد سیاست‌های امنیتی
سیاست امنیتی با نام /Common/_App.kateb.ir از تاریخ 2024-07-01 اعمال شده و به‌خوبی توانسته است درخواست‌های غیرمجاز را مسدود کند.

توصیه‌ها برای تیم SOC
اقدامات امنیتی بیشتر

از صحت هدرهای HTTP اطمینان حاصل کنید و درخواست‌هایی که هدر Host شامل IP است را مستقیماً مسدود کنید.
قوانین سختگیرانه‌تری برای درخواست‌های مشابه (مانند تلاش‌های مکرر به /) تنظیم کنید.
نظارت دقیق‌تر

الگوهای درخواست‌های مشکوک را شناسایی کنید و سیستم هشداردهی برای این الگوها فعال کنید.
تلاش‌های متعدد و ناموفق را برای یافتن نقاط ضعف رصد کنید.
پاسخ به تهدیدات

بررسی کنید که آیا این ترافیک می‌تواند مقدمه‌ای برای حملات هدفمند باشد.
اضافه کردن مکانیزم‌هایی مثل CAPTCHA برای مسیرهای حساس سرور می‌تواند مؤثر باشد.
گزارش‌دهی و بهبود سیاست‌ها

تأکید بر اثربخشی سیاست امنیتی در جلوگیری از این نوع حملات.
تنظیم قوانین پیشگیرانه جدید برای تقویت دفاع در برابر حملات احتمالی مشابه.
